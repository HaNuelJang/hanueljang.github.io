<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Garbage Collection" /><meta property="og:locale" content="en" /><meta name="description" content="JAVA의 Garbage Collection을 알아보자." /><meta property="og:description" content="JAVA의 Garbage Collection을 알아보자." /><link rel="canonical" href="https://hanueljang.github.io//posts/GC/" /><meta property="og:url" content="https://hanueljang.github.io//posts/GC/" /><meta property="og:site_name" content="기술정리 블로그" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-04-11T10:59:10+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Garbage Collection" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="i7DonAsg2XevX1vbo0yJyGpmzhwsylBrYop20xy_Z48" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-04-13T08:19:30+09:00","datePublished":"2022-04-11T10:59:10+09:00","description":"JAVA의 Garbage Collection을 알아보자.","headline":"Garbage Collection","mainEntityOfPage":{"@type":"WebPage","@id":"https://hanueljang.github.io//posts/GC/"},"url":"https://hanueljang.github.io//posts/GC/"}</script><title>Garbage Collection | 기술정리 블로그</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="기술정리 블로그"><meta name="application-name" content="기술정리 블로그"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8993100314477491" crossorigin="anonymous"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/ir.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">기술정리 블로그</a></div><div class="site-subtitle" style="letter-spacing: -0.02em;">JAVA WEB BackEnd</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/focuschange" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a> <a href=" javascript:location.href = 'mailto:' + ['hanueljang082','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Garbage Collection</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Garbage Collection</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/HaNuelJang">Hanuel Jang</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-04-11 10:59:10 +0900" data-toggle="tooltip" data-placement="bottom" title="Mon, Apr 11, 2022, 10:59 AM +0900" >Apr 11</em> </span> <span> Updated <em class="timeago" date="2022-04-13 08:19:30 +0900 " data-toggle="tooltip" data-placement="bottom" title="Wed, Apr 13, 2022, 8:19 AM +0900" >Apr 13</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1882 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><h1 id="gcgarbage-collection">GC(Garbage Collection)</h1><hr /><p>자동으로 <code class="language-plaintext highlighter-rouge">Heap영역</code>의 메모리를 관리하는 쓰레드. Heap에서 Unreachable Object들을 mark후 sweep하는 작업을 처리하여 Heap을 확보한다. Heap은 다음과 같은 영역으로 나뉜다.</p><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/103012019/162836156-77050729-7c4b-4601-a076-e10ce7fb1b81.png" alt="java-memory-management_gc-6" /></p><ul><li><p>YG(Minor GC)<br /> <strong><code class="language-plaintext highlighter-rouge">Eden</code></strong>: 처음 객체가 생성될 때 적재되는 공간<br /> <strong><code class="language-plaintext highlighter-rouge">Survivor1,2</code></strong>: Eden의 메모리가 가득차면 <code class="language-plaintext highlighter-rouge">Minor GC</code>가 발생한다. 이때 reachable Object를 Survivor영역으로 옮기는 작업을 한다.(단, Survivor영역의 한곳은 항상 비워둔다.)</p><li><p>OG(Major GC)<br /> YG영역에서 장기간 살아남은 객체는 OG로 이동하게 된다.<br /> <br /></p></ul><p><strong><mark>Metaspace</mark></strong>(~Java7까지 Permanent영역)</p><blockquote><ul><li>Permanent Generation은 힙 메모리 영역중에 하나로 자바 애플리케이션을 실행할때 클래스의 메타데이터(클래스의 이름, 생성자, 필드, 메소드 정보…)를 저장하는 영역이다.(Java 7기준)<li>OutOfMemoryError: PermGen Space error 는 더이상 볼 수 없고 JVM 옵션으로 사용했던 PermSize 와 MaxPermSize는 더이상 사용할 필요가 없다. 이 대신에 MetaspaceSize 및 MaxMetaspaceSize가 새롭게 사용되게 되었다.</ul><p>기존 Permanent영역은 고정된 크기로 할당되었다. 하지만 동적으로 생성되는 Class데이터들로 이로인해 OOM관련 이슈가 존재했었다. 이를 해결하기 위해 OS레벨에서 관리되는 Native메모리 영역으로 변경되면서, 개발자는 Metaspace의 영역에 대해 크게 의식할 필요가 없어지게 되었다.</p></blockquote><p><br /></p><p><strong><mark>YG/OG비교</mark></strong></p><blockquote><p>메모리 크기: YG &lt; OG<br /> 처리빈도: YG &gt; OG</p><p><mark>Why?</mark> 대체로 객체는 장시간 참조되지 않는다. 그리고 오래된 객체는 대부분 새로 생성된 객체를 참조하지 않는다. 따라서 YG의 <code class="language-plaintext highlighter-rouge">Minor GC</code>는 빈번하게 처리된다.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/103012019/162831662-f832b879-4e23-4372-864d-d0c182e9c4ed.png" alt="jsgct_dt_003_alc_vs_srvng" /></p></blockquote><p><br /></p><h2 id="gc시나리오">GC시나리오<a href="#gc시나리오"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Eden이 가득차면 reachable Object을 탐색하고 Survivor1로 옮긴다. (Eden 메모리 초기화)<li>다음 <code class="language-plaintext highlighter-rouge">Minor GC</code>에서는 Eden, Survivor1을 탐색하고 Survivor2로 옮긴다. (Eden, Survivor1 메모리 초기화)<li>다음 <code class="language-plaintext highlighter-rouge">Minor GC</code>에서는 Eden, Survivor2를 탐색하고 Survivor1로 옮긴다. (Eden, Survivor2 메모리 초기화)<li>이 작업이 반복되면서 Survivor영역의 객체들은 Age값을 갖고, Survivor영역에서 다른 Survivor영역으로 이동될때 Age값이 증가한다.<li>Age값이 설정된 임계치를 넘게되면, 해당 객체들은 OG영역으로 이동하게 된다.<li>OG의 메모리가 가득차면, <code class="language-plaintext highlighter-rouge">Major GC</code>가 발생한다. OG의 reachable Object들을 탐색 후, 메모리를 정리한다.</ol><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 450 400'%3E%3C/svg%3E" data-proofer-ignore data-src="https://user-images.githubusercontent.com/103012019/162663678-68c1c8d9-3bd2-486b-b8a5-e56661c6ca3f.png" width="450" height="400" /><br /> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 450 408'%3E%3C/svg%3E" data-proofer-ignore data-src="https://user-images.githubusercontent.com/103012019/162663759-0c1075b8-c29a-43df-b864-c5cd2d293cf8.png" width="450" height="408" /><br /> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 450 400'%3E%3C/svg%3E" data-proofer-ignore data-src="https://user-images.githubusercontent.com/103012019/162664095-d8118ca7-00e9-4905-8583-ad37c5ada57f.png" width="450" height="400" /></p><h1 id="gc알고리즘">GC알고리즘</h1><hr /><ul><li>Serial GC<li>Parallel GC<li>Parallel Old GC<li>CMS GC(Concurrent Mark &amp; Sweep GC)<li>G1 GC(Garbage First GC) <br /></ul><h2 id="serial-gc">Serial GC<a href="#serial-gc"><i class="fas fa-hashtag"></i></a></h2></h2><p>Heap의 앞부분부터 확인(Mark)하여 살아있는 것만 남기고(Sweep), 객체들이 연속되도록 Compaction 하는 작업<br /> 기본적인 <code class="language-plaintext highlighter-rouge">Mark-Sweep-Compaction</code> 알고리즘에 해당<br /> 싱글 쓰레드로 작업을 수행하며, Stop-The-World 시간이 상대적으로 길다.(서버환경에서는 사용하지 않는것이 바람직하다)</p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="cm">/* 사용옵션 */</span>
<span class="o">-</span><span class="nl">XX:</span><span class="o">+</span><span class="nc">UseSerialGC</span>
</pre></table></code></div></div><p><br /></p><h2 id="parallel-gc">Parallel GC<a href="#parallel-gc"><i class="fas fa-hashtag"></i></a></h2></h2><p>Serial GC의 멀티 쓰레드 방식</p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="cm">/* 사용옵션 */</span>
<span class="o">-</span><span class="nl">XX:</span><span class="o">+</span><span class="nc">UseParallelGC</span>     <span class="c1">//Minor GC만 멀티 스레드로 동작하고, Major GC는 싱글 스레드 동작  </span>

<span class="cm">/* 스레드 수 변경 옵션 */</span>  
<span class="cm">/* 기본적으로 JVM이 구동되는 환경의 CPU 코어 개수에 맞춰서 N개의 GC가 수행된다. */</span>  
<span class="o">-</span><span class="nl">XX:</span><span class="nc">ParallelGCThreads</span><span class="o">=</span><span class="no">N</span><span class="o">(</span><span class="n">스레드수</span><span class="o">)</span>
</pre></table></code></div></div><p><br /></p><h2 id="parallel-old-gc">Parallel Old GC<a href="#parallel-old-gc"><i class="fas fa-hashtag"></i></a></h2></h2><p>Parallel GC와 다른점은 <code class="language-plaintext highlighter-rouge">Mark-Summary-Compaction</code> 단계를 거쳐서 객체를 식별<br /> Summary 에 해당하는 작업이 GC를 수행한 영역에 대해서 살아있는 객체를 식별한다는 작업</p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="cm">/* 사용옵션 */</span>
<span class="o">-</span><span class="nl">XX:</span><span class="o">+</span><span class="nc">UseParallelOldGC</span>  <span class="c1">//Minor GC, Major GC 멀티 스레드로 동작  </span>
</pre></table></code></div></div><p><br /></p><h2 id="cms-gcconcurrent-mark--sweep-gc">CMS GC(Concurrent Mark &amp; Sweep GC)<a href="#cms-gcconcurrent-mark--sweep-gc"><i class="fas fa-hashtag"></i></a></h2></h2><p>Stop-The-World 시간이 짧다.<br /> Compaction을 수행하지는 않기 때문에 메모리 단편화가 발생한다. 이때 Concurrent mode failure 경고가 나면서 Compaction 작업을 수행하는데, 다른 GC의 Stop-The-World 시간보다도 긴 시간이 소요돼서 서버 환경에서는 위험할 수 있다.</p><ol><li>Initial Mark: GC Tree의 Root중 살아있는 객체만 선별(STW시간이 매우 짧다.)<li>Concurrent Mark: Mark단계에서 선별된 객체부터 Tree탐색을 하면서 참조중인 살아있는 객체를 확인한다.<li>Remark: 위 단계를 한번더 검증한다.(새로 추가되거나 참조가 끊긴 객체를 확인한다. STW발생-멀티쓰레드로 동작)<li>Concurrent Sweep: GC대상을 정리한다.</ol><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="cm">/* 사용옵션 */</span>
<span class="o">-</span><span class="nl">XX:</span><span class="o">+</span><span class="nc">UseConcMarkSweepGC</span>
</pre></table></code></div></div><p><br /></p><h2 id="g1-gcgarbage-first-gc">G1 GC(Garbage First GC)<a href="#g1-gcgarbage-first-gc"><i class="fas fa-hashtag"></i></a></h2></h2><p>JDK7 부터 공식적으로 도입된 서버형 GC. 대용량 메모리에 적합한 솔루션을 제공하기 위해 사용한다.<br /> JDK11 부터 공식적인 GC알고리즘으로 적용.</p><blockquote><p>G1 GC는 메모리를 페이징 하듯이 논리적인 단위(Region)로 나눠서 관리한다는 것이다.<br /> Region이라는 논리적인 단위로 메모리를 관리하여 CMS와 달리 Compaction 단계를 진행하고 메모리 단편화 문제를 없앴다.<br /> 또한 STW의 시간을 예측할 수 있다는 것이 G1 GC의 큰 장점 중 하나이다.</p></blockquote><p><br /></p><h1 id="general-gc-mark절차">General GC Mark절차</h1><ol><li>Softly References<li>Weakly References<li>finalize<li>Phantomly References<li>Memory Sweep</ol><h2 id="gc대상-세분화">GC대상 세분화<a href="#gc대상-세분화"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="root-set이-되기-위한-조건">Root Set이 되기 위한 조건<a href="#root-set이-되기-위한-조건"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>각각의 쓰레드의 Stack 영역에 존재하는 Local Variable, Operand Stack에 존재하는 참조 값 등<li>JNI (Java Native Interface)를 통해 생성된 객체들<li>메서드 영역의 정적 변수에 의한 참조 <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/103012019/163066763-c38efbf6-f51a-404b-af30-bd1b68b2f368.png" alt="helloworld-329631-1" /></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>Reachable: (Root Set을 기준으로)Heap 영역에 존재하고 있는 객체의 유효한 참조가 존재하는 경우  
Unreahable: (Root Set을 기준으로)유효한 참조가 존재하지 않는 경우 - __`GC대상`__  
![helloworld-329631-2](https://user-images.githubusercontent.com/103012019/163067083-03750d3b-eb5d-4bc3-934b-0897f498ebc7.png)
</pre></table></code></div></div><h3 id="soft-weak-phantom-reference">Soft, Weak, Phantom Reference<a href="#soft-weak-phantom-reference"><i class="fas fa-hashtag"></i></a></h3></h3><p>java.lang.ref는 SoftReference, WeakReference, phantom reference를 클래스 형태로 제공</p><p>SoftReference - JVM의 메모리가 부족한 경우에만 힙영역에서 제거되고 메모리가 부족하지 않다면 굳이 제거하지 않는다. null인 경우 GC대상 WeakReference - WeakReference만 남아있는 경우, GC대상</p><p>PhantomReference - 이전작업이 끝나고 메모리가 해제 된 것을 <code class="language-plaintext highlighter-rouge">확인</code> 후에 다음 작업을 진행할 때 사용. 생성자에서 무조건 ReferenceQueue를 받습니다.</p><h3 id="strengths-of-reachability">Strengths of Reachability<a href="#strengths-of-reachability"><i class="fas fa-hashtag"></i></a></h3></h3><p>java.lang.ref 패키지를 이용하여 reachable 객체들을 모두 다른 접근성 수준을 가질 수 있다. 따라서 개발자가 GC대상 판별 작업에 개입할수 있게 되었다.</p><ul><li><dl><dt>strongly<dd>일반적으로 생성되는 Object</dl><li><dl><dt>softly<dd>(SoftReference) 사용 빈도수를 계산하여 GC대상 여부 판별</dl></ul><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="cm">/* 사용 빈도수 계산 */</span>  
<span class="nl">XX:</span><span class="nc">SoftRefLRUPolicyMSPerMB</span> <span class="o">=</span> <span class="no">NUMBER</span>

<span class="cm">/* 예시 */</span>
<span class="no">GC</span> <span class="n">시간</span> <span class="o">&gt;</span> <span class="no">NUMBER</span> <span class="o">*</span> <span class="nc">Heap</span> <span class="nc">Memory</span>
<span class="err">→</span> <span class="n">옵션</span> <span class="n">설정</span> <span class="n">값이</span> <span class="mi">1000</span><span class="n">이라면</span> <span class="mi">1</span><span class="o">,</span><span class="mo">000</span><span class="n">ms</span> <span class="o">/</span> <span class="no">MB</span> <span class="o">*</span> <span class="mi">100</span><span class="no">MB</span> <span class="o">=</span> <span class="mi">100</span><span class="o">,</span><span class="mo">000</span> <span class="n">ms</span> <span class="o">=</span> <span class="mi">100</span> <span class="n">sec</span> <span class="n">즉</span> <span class="n">회수</span> <span class="n">시간은</span> <span class="mi">100</span><span class="n">초</span>
</pre></table></code></div></div><ul><li><dl><dt>weakly<dd>(WeakReference) GC발생시 해당 객체들은 Sweep대상</dl><li><dl><dt>phantomly reachable<dd>다른 모든 단계에 포함되지 않는 Object -&gt; finalize를 통해 다음 GC의 Sweep대상으로 특정 queue에 저장</dl><li><dl><dt>unReachable Object<dd>유효 참조가 없는 객체</dl></ul><h1 id="참조">참조</h1><hr /><p>https://d2.naver.com/helloworld/329631</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/java/'>JAVA</a>, <a href='/categories/jvm/'>JVM</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/java/" class="post-tag no-text-decoration" >JAVA</a> <a href="/tags/gc/" class="post-tag no-text-decoration" >GC</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"></div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Garbage Collection - 기술정리 블로그&url=https://hanueljang.github.io//posts/GC/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Garbage Collection - 기술정리 블로그&u=https://hanueljang.github.io//posts/GC/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Garbage Collection - 기술정리 블로그&url=https://hanueljang.github.io//posts/GC/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div><script src="https://utteranc.es/client.js" repo="focuschange/focuschange.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/API-String/">String, String Builder, and String Buffer</a><li><a href="/posts/OAuth2.0/">OAuth 2.0</a><li><a href="/posts/servlet/">(Servlet / Spring / Web Application) Context, Container</a><li><a href="/posts/step1/">객체지향 설계 연습_1</a><li><a href="/posts/Programming/">프로그램_설계_1</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">JAVA</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/thread/">Thread</a> <a class="post-tag" href="/tags/aoc/">AOC</a> <a class="post-tag" href="/tags/bean/">Bean</a> <a class="post-tag" href="/tags/collection/">Collection</a> <a class="post-tag" href="/tags/container/">Container</a> <a class="post-tag" href="/tags/context/">Context</a> <a class="post-tag" href="/tags/di/">DI</a> <a class="post-tag" href="/tags/gc/">GC</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/java-memory/"><div class="card-body"> <em class="timeago small" date="2022-04-09 10:59:10 +0900" >Apr 9</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>JVM Memory Structure</h3><div class="text-muted small"><p> JVM은 무엇인가 JAVA Virtual Machine JRE의 한 부분(구성요소) OS에 영향을 받지 않고 클래스파일(ByteCode)을 실행 GC(메모리 관리)수행 JVM은 무엇을 하는가 먼저 작성한 Java소스를 Java Compiler 의해 Class파일(ByteCode)로 변환한다. JVM은 OS로부터 메모리를...</p></div></div></a></div><div class="card"> <a href="/posts/Thread/"><div class="card-body"> <em class="timeago small" date="2022-04-17 00:59:10 +0900" >Apr 17</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>스레드(Thread) - 개념</h3><div class="text-muted small"><p> 스레드란? 프로그램: 실행파일 프로세스: CPU를 차지하면서 수행하는 주체, 프로그램의 인스턴스 스레드: 프로세스 내부에서 자원을 공유하며 처리하는 단위, 작업을 효율적으로 처리하기 위한 모델 스레드 종류 일반 스레드(User Thread) = 일반적으로 구현하는 스레드, Main Thread()도 포함된다. 데몬 스레드(Daemo...</p></div></div></a></div><div class="card"> <a href="/posts/Thread2/"><div class="card-body"> <em class="timeago small" date="2022-04-18 00:59:10 +0900" >Apr 18</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>스레드(Thread) - 심화</h3><div class="text-muted small"><p> 스레드 동기화(Synchronized) 멀티 스레드는 여러 작업을 동시성을 갖고 처리 할 수 있는 이점이 있다. 하지만 때로는 그 결과가 기대한 값과 다른 결과가 나오는 일이 발생한다. 스레드의 특징인 자원을 공유하는 것이 문제점이 된다. 서로 다른 스레드가 하나의 공유 자원에 동시에 접근하는 경우 그렇다. 이러한 문제점을 해결하는 방법을 알아 보...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/java-memory/" class="btn btn-outline-primary" prompt="Older"><p>JVM Memory Structure</p></a> <a href="/posts/Thread/" class="btn btn-outline-primary" prompt="Newer"><p>스레드(Thread) - 개념</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/HaNuelJang">Hanuel Jang</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">All rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">JAVA</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/thread/">Thread</a> <a class="post-tag" href="/tags/aoc/">AOC</a> <a class="post-tag" href="/tags/bean/">Bean</a> <a class="post-tag" href="/tags/collection/">Collection</a> <a class="post-tag" href="/tags/container/">Container</a> <a class="post-tag" href="/tags/context/">Context</a> <a class="post-tag" href="/tags/di/">DI</a> <a class="post-tag" href="/tags/gc/">GC</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script> <script data-ad-client="ca-pub-8993100314477491" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
